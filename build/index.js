(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Chatbot:()=>L,createChatBotMessage:()=>c,createClientMessage:()=>u,createCustomMessage:()=>l,default:()=>F,useChatbot:()=>A});const r=require("react");var a=e.n(r);const n=require("react-conditionally-render");var o=e.n(n),s=function(){return s=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},s.apply(this,arguments)},i=function(e,t){return{message:e,type:t,id:Math.round(Date.now()*Math.random())}},c=function(e,t){return s(s(s({},i(e,"bot")),t),{loading:!0})},l=function(e,t,r){return s(s({},i(e,t)),r)},u=function(e,t){return s(s({},i(e,"user")),t)},m=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e)return e.apply(void 0,t)};function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},g.apply(this,arguments)}const d=({styles:e={},...t})=>a().createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t),a().createElement("path",{d:"M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z"})),p=function(e){var t=e.message,r=e.customComponents,n=e.image,s=e.audioFile;return a().createElement("div",{className:"react-chatbot-kit-user-chat-message-container"},a().createElement(o(),{condition:!!r.userChatMessage,show:m(r.userChatMessage,{message:t,image:n,audioFile:s}),elseShow:a().createElement("div",{className:"react-chatbot-kit-user-chat-message"},t,a().createElement("div",{className:"react-chatbot-kit-user-chat-message-arrow"}))}),a().createElement(o(),{condition:!!r.userAvatar,show:m(r.userAvatar),elseShow:a().createElement("div",{className:"react-chatbot-kit-user-avatar"},a().createElement("div",{className:"react-chatbot-kit-user-avatar-container"},a().createElement(d,{className:"react-chatbot-kit-user-avatar-icon"})))}))},f=function(){return a().createElement("div",{className:"react-chatbot-kit-chat-bot-avatar"},a().createElement("div",{className:"react-chatbot-kit-chat-bot-avatar-container"},a().createElement("p",{className:"react-chatbot-kit-chat-bot-avatar-letter"},"B")))},v=function(){return a().createElement("div",{className:"chatbot-loader-container"},a().createElement("svg",{id:"dots",width:"50px",height:"21px",viewBox:"0 0 132 58",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},a().createElement("g",{stroke:"none",fill:"none"},a().createElement("g",{id:"chatbot-loader",fill:"#fff"},a().createElement("circle",{id:"chatbot-loader-dot1",cx:"25",cy:"30",r:"13"}),a().createElement("circle",{id:"chatbot-loader-dot2",cx:"65",cy:"30",r:"13"}),a().createElement("circle",{id:"chatbot-loader-dot3",cx:"105",cy:"30",r:"13"})))))};var h=function(){return h=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},h.apply(this,arguments)};const y=function(e){var t=e.message,n=e.withAvatar,s=void 0===n||n,i=e.loading,c=e.messages,l=e.customComponents,u=e.setState,g=e.customStyles,d=e.delay,p=e.id,y=(0,r.useState)(!1),b=y[0],w=y[1];(0,r.useEffect)((function(){var e;return function(t,r){var a=750;d&&(a+=d),e=setTimeout((function(){var e=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}([],t,!0).map((function(e){return e.id===p?h(h({},e),{loading:!1,delay:void 0}):e}));r((function(t){return h(h({},t),{messages:e})}))}),a)}(c,u),function(){clearTimeout(e)}}),[d,p]),(0,r.useEffect)((function(){d?setTimeout((function(){return w(!0)}),d):w(!0)}),[d]);var E={backgroundColor:""},S={borderRightColor:""};return g&&(E.backgroundColor=g.backgroundColor,S.borderRightColor=g.backgroundColor),a().createElement(o(),{condition:b,show:a().createElement("div",{className:"react-chatbot-kit-chat-bot-message-container"},a().createElement(o(),{condition:s,show:a().createElement(o(),{condition:!!(null==l?void 0:l.botAvatar),show:m(null==l?void 0:l.botAvatar),elseShow:a().createElement(f,null)})}),a().createElement(o(),{condition:!!(null==l?void 0:l.botChatMessage),show:m(null==l?void 0:l.botChatMessage,{message:t,loader:a().createElement(v,null)}),elseShow:a().createElement("div",{className:"react-chatbot-kit-chat-bot-message",style:E},a().createElement(o(),{condition:i,show:a().createElement(v,null),elseShow:a().createElement("span",null,t)}),a().createElement(o(),{condition:s,show:a().createElement("div",{className:"react-chatbot-kit-chat-bot-message-arrow",style:S})}))}))})};function b(){return b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},b.apply(this,arguments)}const w=({styles:e={},...t})=>a().createElement("svg",b({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t),a().createElement("path",{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"}));function E(){return E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},E.apply(this,arguments)}const S=({styles:e={},...t})=>a().createElement("svg",E({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},t),a().createElement("path",{d:"M12 1a4 4 0 00-4 4v6a4 4 0 008 0V5a4 4 0 00-4-4z"}),a().createElement("path",{d:"M19 10v2a7 7 0 01-14 0v-2M12 19v4M8 23h8"}));function k(){return k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},k.apply(this,arguments)}const P=({styles:e={},...t})=>a().createElement("svg",k({width:"24",height:"24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),a().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 7a5 5 0 0110 0v8a7 7 0 11-14 0V9a1 1 0 012 0v6a5 5 0 0010 0V7a3 3 0 10-6 0v8a1 1 0 102 0V9a1 1 0 112 0v6a3 3 0 11-6 0V7z",fill:"currentColor"}));var O=function(){return O=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},O.apply(this,arguments)},C=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))};const M=function(e){var t=e.state,n=e.setState,s=e.widgetRegistry,c=e.messageParser,l=e.parse,u=e.customComponents,m=e.actionProvider,g=e.botName,d=e.customStyles,f=e.headerText,v=e.customMessages,h=e.placeholderText,b=e.validator,E=e.disableScrollToBottom,k=e.messageHistory,M=e.actions,x=e.messageContainerRef,N=t.messages,j=(0,r.useState)(""),T=j[0],I=j[1],R=(0,r.useState)(null),B=R[0],A=R[1],H=(0,r.useState)(null),L=H[0],F=H[1],W=function(){setTimeout((function(){var e;x.current&&(x.current.scrollTop=null===(e=null==x?void 0:x.current)||void 0===e?void 0:e.scrollHeight)}),50)};(0,r.useEffect)((function(){E||W()}));var V=function(){n((function(e){return O(O({},e),{messages:C(C([],e.messages,!0),[i(T,"user")],!1)})})),W(),I(""),A(null),F(null)},_={backgroundColor:""};d&&d.chatButton&&(_.backgroundColor=d.chatButton.backgroundColor);var z="Conversation with "+g;f&&(z=f);var D="Write your message here";h&&(D=h);var q=(0,r.useState)(!1),J=q[0],U=q[1],G=(0,r.useState)(!1),K=G[0],Q=G[1],X=function(){var e=localStorage.getItem("app-setting");if(e){var t=JSON.parse(e);t.url&&t.url.includes("ask/vision")?(U(!0),F(null)):U(!1)}};(0,r.useEffect)((function(){return X(),window.addEventListener("storage",X),function(){window.removeEventListener("storage",X)}}),[]);var Y=function(){var e=localStorage.getItem("app-setting");e&&(JSON.parse(e).sendBtnDisable?Q(!0):Q(!1))};(0,r.useEffect)((function(){return window.addEventListener("app-setting-update",Y),function(){window.removeEventListener("app-setting-update",Y)}}),[]);var Z=(0,r.useState)(!1),$=Z[0],ee=Z[1],te=(0,r.useState)(""),re=(te[0],te[1]),ae=(0,r.useState)(!1),ne=ae[0],oe=ae[1],se=(0,r.useState)(!1),ie=se[0],ce=se[1];(0,r.useEffect)((function(){"undefined"!=typeof window&&(window.SpeechRecognition||window.webkitSpeechRecognition)&&oe(!0)}),[]),(0,r.useEffect)((function(){if(K)ce(!0);else{var e=J&&!B||T.length<1;ce(e)}}),[J,B,T,K]);var le=(0,r.useState)("Listening ..."),ue=le[0],me=le[1];return(0,r.useEffect)((function(){var e;return $&&(e=setInterval((function(){me((function(e){return"Listening ..."===e?"Listening ..":"Listening ..."}))}),400)),function(){clearInterval(e)}}),[$]),a().createElement("div",{className:"react-chatbot-kit-chat-container"},a().createElement("div",{className:"react-chatbot-kit-chat-inner-container"},a().createElement(o(),{condition:!!u.header,show:u.header&&u.header(m),elseShow:a().createElement("div",{className:"react-chatbot-kit-chat-header"},z)}),a().createElement("div",{className:"react-chatbot-kit-chat-message-container",ref:x},a().createElement(o(),{condition:"string"==typeof k&&Boolean(k),show:a().createElement("div",{dangerouslySetInnerHTML:{__html:k}})}),N.map((function(e,r){return"bot"===e.type?a().createElement(a().Fragment,{key:e.id},function(e,r){var i;i=e.withAvatar?e.withAvatar:function(e,t){if(0===t)return!0;var r=e[t-1];return!("bot"===r.type&&!r.widget)}(N,r);var c=O(O({},e),{setState:n,state:t,customComponents:u,widgetRegistry:s,messages:N,actions:M});if(e.widget){var l=s.getWidget(c.widget,O(O({},t),{scrollIntoView:W,payload:e.payload,actions:M}));return a().createElement(a().Fragment,null,a().createElement(y,O({customStyles:d.botMessageBox,withAvatar:i},c,{key:e.id})),a().createElement(o(),{condition:!c.loading,show:l||null}))}return a().createElement(y,O({customStyles:d.botMessageBox,key:e.id,withAvatar:i},c,{customComponents:u,messages:N,setState:n}))}(e,r)):"user"===e.type?a().createElement(a().Fragment,{key:e.id},function(e){var r=s.getWidget(e.widget,O(O({},t),{scrollIntoView:W,payload:e.payload,actions:M}));return a().createElement(a().Fragment,null,a().createElement(p,{message:e.message,key:e.id,customComponents:u,image:e.image,audioFile:e.audioFile}),r||null)}(O(O({},e),{image:t.image,audioFile:t.audioFile}))):function(e,t){return!!t[e.type]}(e,v)?a().createElement(a().Fragment,{key:e.id},function(e){var r=v[e.type],o={setState:n,state:t,scrollIntoView:W,actionProvider:m,payload:e.payload,actions:M};if(e.widget){var i=s.getWidget(e.widget,O(O({},t),{scrollIntoView:W,payload:e.payload,actions:M}));return a().createElement(a().Fragment,null,r(o),i||null)}return r(o)}(e)):void 0})),a().createElement("div",{style:{paddingBottom:"15px"}})),a().createElement("div",{className:"react-chatbot-kit-chat-input-container"},a().createElement("div",{className:"react-chatbot-kit-chat-input-form"},a().createElement("div",{className:"microphone-audio-wrapper"},a().createElement(a().Fragment,null,!$&&a().createElement(S,{className:"react-chatbot-kit-mic-icon",onClick:function(){if(ne)try{var e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e)throw new Error("Speech recognition is not supported by this browser.");var t=new e;t.lang="en-US",t.interimResults=!1,t.maxAlternatives=1,$||(ee(!0),t.start()),t.onresult=function(e){var t=e.results[0][0].transcript;re(t),I(t),ee(!1)},t.onerror=function(e){console.error("Error occurred in recognition:",e.error),ee(!1)},t.onend=function(){ee(!1)}}catch(e){console.error("Speech recognition error:",e)}else alert("Speech recognition is not supported in this browser.")}}),$&&a().createElement("p",{style:{width:"120px",marginLeft:"10px"}},ue)),!J&&a().createElement(P,{className:"react-chatbot-kit-file-icon",onClick:function(){document.getElementById("fileInput").click()}}),a().createElement("input",{type:"file",id:"fileInput",style:{display:"none"},accept:".mp3, .mp4, .mpeg, .mpga, .m4a, .wav, .webm, .x-m4a",onChange:function(e){var t=e.target.files[0];t&&F(t),e.target.value=null}}),a().createElement("span",null,L&&(L.name.length>20?L.name.slice(0,20)+"."+L.name.split(".").pop():L.name))),a().createElement("textarea",{className:"react-chatbot-kit-chat-input",placeholder:D,value:T,onChange:function(e){return I(e.target.value)}}),a().createElement(a().Fragment,null,J&&a().createElement("button",{className:"react-chatbot-kit-select-image",onClick:function(e){e.stopPropagation(),document.getElementById("imageInput").click()}},B&&(B.name.length>20?B.name.slice(0,20)+"."+B.name.split(".").pop():B.name)||"Select Image"),a().createElement("input",{type:"file",id:"imageInput",style:{display:"none"},accept:"image/*",onChange:function(e){e.stopPropagation();var t=e.target.files[0];t&&A(t),e.target.value=null}})),a().createElement("button",{className:"react-chatbot-kit-chat-btn-send",style:O(O({},_),{backgroundColor:ie?"grey":"rgb(0, 74, 173)",height:"100%"}),onClick:function(e){if(e.preventDefault(),b&&"function"==typeof b){if(b(T)){if(V(),l)return l(T,B,L);c.parse(T,B,L)}}else{if(V(),l)return l(T,B,L);c.parse(T,B,L)}},disabled:ie},a().createElement(w,{className:"react-chatbot-kit-chat-btn-send-icon"}))))))},x=function(e){var t=e.message;return a().createElement("div",{className:"react-chatbot-kit-error"},a().createElement("h1",{className:"react-chatbot-kit-error-header"},"Ooops. Something is missing."),a().createElement("div",{className:"react-chatbot-kit-error-container"},a().createElement(y,{message:t,withAvatar:!0,loading:!1,id:1,customStyles:{backgroundColor:""},messages:[]})),a().createElement("a",{href:"https://fredrikoseberg.github.io/react-chatbot-kit-docs/",rel:"noopener norefferer",target:"_blank",className:"react-chatbot-kit-error-docs"},"View the docs"))};var N=function(e){return e.widgets?e.widgets:[]},j=function(e){try{new e}catch(e){return!1}return!0},T=function(){return T=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},T.apply(this,arguments)};const I=function(e,t){var r=this;this.addWidget=function(e,t){var a=e.widgetName,n=e.widgetFunc,o=e.mapStateToProps,s=e.props;r[a]={widget:n,props:s,mapStateToProps:o,parentProps:T({},t)}},this.getWidget=function(e,t){var a=r[e];if(a){var n,o=T(T(T(T({scrollIntoView:t.scrollIntoView},a.parentProps),"object"==typeof(n=a.props)?n:{}),r.mapStateToProps(a.mapStateToProps,t)),{setState:r.setState,actionProvider:r.actionProvider||t.actions,actions:t.actions,state:t,payload:t.payload});return a.widget(o)||null}},this.mapStateToProps=function(e,t){if(e)return e.reduce((function(e,r){return e[r]=t[r],e}),{})},this.setState=e,this.actionProvider=t};var R=function(){return R=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},R.apply(this,arguments)},B=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))};const A=function(e){var t=e.config,n=e.actionProvider,o=e.messageParser,s=e.messageHistory,i=(e.runInitialMessagesWithHistory,e.saveMessages),m=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r}(e,["config","actionProvider","messageParser","messageHistory","runInitialMessagesWithHistory","saveMessages"]),g="",d="";if(!t||!n||!o)return{configurationError:g="I think you forgot to feed me some props. Did you remember to pass a config, a messageparser and an actionprovider?"};var p=function(e,t){var r=[];return e.initialMessages||r.push("Config must contain property 'initialMessages', and it expects it to be an array of chatbotmessages."),r}(t);if(p.length)return{invalidPropsError:d=p.reduce((function(e,t){return e+t}),"")};var f,v,h,y=function(e){return e.state?e.state:{}}(t),b=a().useState(R({messages:B([],t.initialMessages,!0)},y)),w=b[0],E=b[1],S=a().useRef(w.messages),k=a().useRef(),P=a().useRef();(0,r.useEffect)((function(){S.current=w.messages})),(0,r.useEffect)((function(){s&&Array.isArray(s)&&E((function(e){return R(R({},e),{messages:s})}))}),[s]),(0,r.useEffect)((function(){var e=P.current;return function(){if(e&&i&&"function"==typeof i){var t=e.innerHTML.toString();i(S.current,t)}}}),[i]),(0,r.useEffect)((function(){k.current=w}),[w]);var O=n,C=o;return j(O)&&j(C)?(f=new n(c,E,u,k.current,l,m),v=new I(E,f),h=new o(f,k.current),N(t).forEach((function(e){return null==v?void 0:v.addWidget(e,m)}))):(f=n,h=o,v=new I(E,null),N(t).forEach((function(e){return null==v?void 0:v.addWidget(e,m)}))),{widgetRegistry:v,actionProv:f,messagePars:h,configurationError:g,invalidPropsError:d,state:w,setState:E,messageContainerRef:P,ActionProvider:O,MessageParser:C}};var H=function(){return H=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},H.apply(this,arguments)};const L=function(e){var t=e.actionProvider,r=e.messageParser,n=e.config,o=e.headerText,s=e.placeholderText,i=e.saveMessages,l=e.messageHistory,u=e.runInitialMessagesWithHistory,m=e.disableScrollToBottom,g=e.validator,d=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r}(e,["actionProvider","messageParser","config","headerText","placeholderText","saveMessages","messageHistory","runInitialMessagesWithHistory","disableScrollToBottom","validator"]),p=A(H({config:n,actionProvider:t,messageParser:r,messageHistory:l,saveMessages:i,runInitialMessagesWithHistory:u},d)),f=p.configurationError,v=p.invalidPropsError,h=p.ActionProvider,y=p.MessageParser,b=p.widgetRegistry,w=p.messageContainerRef,E=p.actionProv,S=p.messagePars,k=p.state,P=p.setState;if(f)return a().createElement(x,{message:f});if(v.length)return a().createElement(x,{message:v});var O=function(e){return e.customStyles?e.customStyles:{}}(n),C=function(e){return e.customComponents?e.customComponents:{}}(n),N=function(e){return e.botName?e.botName:"Bot"}(n),T=function(e){return e.customMessages?e.customMessages:{}}(n);return j(h)&&j(y)?a().createElement(M,{state:k,setState:P,widgetRegistry:b,actionProvider:E,messageParser:S,customMessages:T,customComponents:H({},C),botName:N,customStyles:H({},O),headerText:o,placeholderText:s,validator:g,messageHistory:l,disableScrollToBottom:m,messageContainerRef:w}):a().createElement(h,{state:k,setState:P,createChatBotMessage:c},a().createElement(y,null,a().createElement(M,{state:k,setState:P,widgetRegistry:b,actionProvider:h,messageParser:y,customMessages:T,customComponents:H({},C),botName:N,customStyles:H({},O),headerText:o,placeholderText:s,validator:g,messageHistory:l,disableScrollToBottom:m,messageContainerRef:w})))},F=L;module.exports=t})();